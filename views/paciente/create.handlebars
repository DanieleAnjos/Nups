<h2>Criar Paciente</h2>
<form action="/pacientes" method="POST">
    <label for="cep">CEP:</label>
    <input type="text" name="cep" id="cep" required>
    <button type="button" onclick="buscarEndereco()">Buscar Endereço</button>

    <label for="nome">Nome:</label>
    <input type="text" name="nome" id="nome" required>

    <label for="matricula">Matricula:</label>
    <input type="text" name="matricula" id="matricula" required>


    <label for="dataNascimento">Data de Nascimento:</label>
    <input type="date" name="dataNascimento" id="dataNascimento" required>

    <label for="cpf">CPF:</label>
    <input type="text" name="cpf" id="cpf" required>

    <label for="endereco">Endereço:</label>
    <input type="text" name="endereco" id="endereco" required>

    <label for="sexo">Sexo:</label>
    <select name="sexo" id="sexo" required>
        <option value="Masculino">Masculino</option>
        <option value="Feminino">Feminino</option>
        <option value="Outro">Outro</option>
    </select>

    <label for="telefone">Telefone:</label>
    <input type="text" name="telefone" id="telefone" required>

    <label for="tipoTelefone">Tipo de Telefone:</label>
    <select name="tipoTelefone" id="tipoTelefone" required>
        <option value="Celular">Celular</option>
        <option value="Residencial">Residencial</option>
        <option value="Comercial">Comercial</option>
    </select>

    <label for="bairro">Bairro:</label>
    <input type="text" name="bairro" id="bairro" required>

    <label for="cidade">Cidade:</label>
    <input type="text" name="cidade" id="cidade" required>

    <label for="estado">Estado:</label>
    <input type="text" name="estado" id="estado" required>

    <label for="numero">Número:</label>
    <input type="text" name="numero" id="numero" required>

    <label for="complemento">Complemento:</label>
    <input type="text" name="complemento" id="complemento">

    <label for="historicoMedico">Histórico Médico:</label>
    <input type="text" name="historicoMedico" id="historicoMedico">

    <label for="status">Status:</label>
    <select name="status" id="status" required>
        <option value="Em Atendimento">Em Atendimento</option>
        <option value="Abandono de Tratamento">Abandono de Tratamento</option>
        <option value="Alta">Alta</option>
    </select>

    <label for="encaminhamento">Encaminhamento:</label>
    <select name="encaminhamento" id="encaminhamento" required>
        <option value="Psicologia">Psicologia</option>
        <option value="Serviço Social">Serviço Social</option>
    </select>

    <button type="submit">Salvar</button>
</form>

<script>
async function buscarEndereco() {
    const cep = document.getElementById('cep').value.replace('-', '');
    if (cep) {
        try {
            const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
            const data = await response.json();

            if (!data.erro) {
                document.getElementById('endereco').value = data.logradouro || '';
                document.getElementById('bairro').value = data.bairro || '';
                document.getElementById('cidade').value = data.localidade || '';
                document.getElementById('estado').value = data.uf || '';
            } else {
                alert('CEP não encontrado.');
            }
        } catch (error) {
            alert('Erro ao buscar o endereço.');
        }
    }
}
</script>
