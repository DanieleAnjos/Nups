<main class="container mt-5">
    <h1>Criar Profissional</h1>
    <form action="/profissionais" method="POST" class="mt-4">
        <fieldset>
            <legend>Informações Pessoais</legend>

            <div class="form-group">
                <label for="nome">Nome:</label>
                <input type="text" class="form-control" name="nome" required>
            </div>

            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" class="form-control" name="email" required>
            </div>

            <div class="form-group">
                <label for="cpf">CPF:</label>
                <input type="text" class="form-control" name="cpf" required pattern="\d{11}" title="Deve conter 11 dígitos" onblur="validarCPF(this)">
            </div>

            <div class="form-group">
                <label for="dataNascimento">Data de Nascimento:</label>
                <input type="date" class="form-control" name="dataNascimento" required>
            </div>

            <div class="form-group">
                <label for="sexo">Sexo:</label>
                <select class="form-control" name="sexo" required>
                    <option value="Masculino">Masculino</option>
                    <option value="Feminino">Feminino</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>
        </fieldset>

        <fieldset class="mt-4">
            <legend>Informações Profissionais</legend>

            <div class="form-group">
                <label for="matricula">Matrícula:</label>
                <input type="number" class="form-control" name="matricula" required>
            </div>

            <div class="form-group">
                <label for="dataAdmissao">Data de Admissão:</label>
                <input type="date" class="form-control" name="dataAdmissao" required>
            </div>

            <div class="form-group">
                <label for="cargo">Cargo:</label>
                <select class="form-control" name="cargo" required>
                    <option value="Assistente social">Assistente social</option>
                    <option value="Administrador">Administrador</option>
                    <option value="Psicólogo">Psicólogo</option>
                    <option value="Psiquiatra">Psiquiatra</option>
                </select>
            </div>

            <div class="form-group">
                <label for="vinculo">Vínculo:</label>
                <select class="form-control" name="vinculo" required>
                    <option value="Servidor">Servidor</option>
                    <option value="Voluntario">Voluntário</option>
                </select>
            </div>
        </fieldset>

        <fieldset class="mt-4">
            <legend>Endereço</legend>

            <div class="form-group">
                <label for="cep">CEP:</label>
                <input type="text" class="form-control" name="cep" required pattern="\d{8}" title="Deve conter 8 dígitos" id="cep">
            </div>

            <div class="form-group">
                <label for="endereco">Endereço:</label>
                <input type="text" class="form-control" name="endereco" required id="endereco">
            </div>

            <div class="form-group">
                <label for="bairro">Bairro:</label>
                <input type="text" class="form-control" name="bairro" required id="bairro">
            </div>

            <div class="form-group">
                <label for="cidade">Cidade:</label>
                <input type="text" class="form-control" name="cidade" required id="cidade">
            </div>

            <div class="form-group">
                <label for="estado">Estado:</label>
                <input type="text" class="form-control" name="estado" required id="estado" readonly>
            </div>

            <div class="form-group">
                <label for="numero">Número:</label>
                <input type="text" class="form-control" name="numero" required>
            </div>

            <div class="form-group">
                <label for="complemento">Complemento:</label>
                <input type="text" class="form-control" name="complemento">
            </div>
        </fieldset>

        <fieldset class="mt-4">
            <legend>Contato</legend>

            <div class="form-group">
                <label for="telefone">Telefone:</label>
                <input type="text" class="form-control" name="telefone" required pattern="\d{10,11}" title="Deve conter 10 ou 11 dígitos">
            </div>

            <div class="form-group">
                <label for="tipoTelefone">Tipo de Telefone:</label>
                <select class="form-control" name="tipoTelefone" required>
                    <option value="Celular">Celular</option>
                    <option value="Residencial">Residencial</option>
                    <option value="Comercial">Comercial</option>
                </select>
            </div>

            <div class="form-group">
                <label for="contatoEmergenciaNome">Contato de Emergência (Nome):</label>
                <input type="text" class="form-control" name="contatoEmergenciaNome">
            </div>

            <div class="form-group">
                <label for="telefoneContatoEmergencia">Contato de Emergência (Telefone):</label>
                <input type="text" class="form-control" name="telefoneContatoEmergencia" pattern="\d{10,11}" title="Deve conter 10 ou 11 dígitos">
            </div>
        </fieldset>

        <fieldset class="mt-4">
            <legend>Acesso ao Sistema</legend>

            <div class="form-group">
                <label for="usuario">Usuário:</label>
                <input type="text" class="form-control" name="usuario" required>
            </div>

            <div class="form-group">
                <label for="senha">Senha:</label>
                <input type="password" class="form-control" name="senha" required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\W_]).{8,}" title="A senha deve conter ao menos 8 caracteres, incluindo uma letra maiúscula, um número e um caractere especial">
            </div>
        </fieldset>

        <button type="submit" class="btn btn-primary mt-4">Criar Profissional</button>
    </form>

    <script>
    document.getElementById('cep').addEventListener('blur', async function() {
        const cep = this.value.replace(/\D/g, '');
        if (cep.length === 8) {
            try {
                const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                const data = await response.json();
                if (!data.erro) {
                    document.getElementById('endereco').value = data.logradouro;
                    document.getElementById('bairro').value = data.bairro;
                    document.getElementById('cidade').value = data.localidade;
                    document.getElementById('estado').value = data.uf;
                } else {
                    alert('CEP não encontrado.');
                }
            } catch (error) {
                alert('Erro ao buscar endereço. Tente novamente.');
            }
        } else {
            alert('CEP deve conter 8 dígitos.');
        }
    });

    function validarCPF(inputCPF) {
        const cpf = inputCPF.value.replace(/\D/g, '');
        if (cpf.length !== 11 || !cpf.match(/^\d{11}$/)) {
            alert('CPF inválido. Deve conter 11 dígitos.');
            inputCPF.focus();
            return false;
        }
        return true;
    }
    </script>
</main>
