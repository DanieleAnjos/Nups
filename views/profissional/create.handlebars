<main class="container mt-5">
    <h2 class="text-center mb-4">Criar Profissional</h2>
    <form action="/profissionais" method="POST" class="mt-4" enctype="multipart/form-data">
        <fieldset class="border rounded p-4 mb-4">
            <legend class="w-auto px-2">Informações Pessoais</legend>
            <div class="row">
                <div class="form-group col-md-6">
                    <label for="nome">Nome:</label>
                    <input type="text" class="form-control" name="nome" required>
                </div>
                <div class="form-group col-md-6">
                    <label for="email">Email:</label>
                    <input type="email" class="form-control" name="email" required>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-4">
                    <label for="rg">RG:</label>
                    <input type="text" class="form-control" name="rg" required title="Deve conter 9 dígitos">
                </div>
                <div class="form-group col-md-4">
                    <label for="cpf">CPF:</label>
                    <input type="text" class="form-control" name="cpf" required pattern="\d{11}" title="Deve conter 11 dígitos" onblur="validarCPF(this)">
                </div>
                <div class="form-group col-md-4">
                    <label for="dataNascimento">Data de Nascimento:</label>
                    <input type="date" class="form-control" name="dataNascimento" required>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-6">
                    <label for="sexo">Sexo:</label>
                    <select class="form-control" name="sexo" required>
                        <option value="" disabled selected>Selecione uma opção</option>
                        <option value="Masculino">Masculino</option>
                        <option value="Feminino">Feminino</option>
                        <option value="Outro">Outro</option>
                    </select>
                </div>
                <div class="form-group col-md-6">
                    <label for="estadoCivil">Estado Civil:</label>
                    <select class="form-control" name="estadoCivil">
                        <option value="" disabled selected>Selecione uma opção</option>
                        <option value="Solteiro">Solteiro(a)</option>
                        <option value="Casado">Casado</option>
                        <option value="Divorciado">Divorciado</option>
                    </select>
                </div>
            </div>
        </fieldset>

        <fieldset class="border rounded p-4 mb-4">
            <legend class="w-auto px-2">Imagem Profissional</legend>
            <div class="form-group">
                <label for="imagem">Carregar Imagem:</label>
                <input type="file" class="form-control" name="imagem" id="imagem" accept="image/*" onchange="previewImage(event)">
                <small class="form-text text-muted">Formato aceito: JPG, PNG, GIF.</small>
                <img id="imagemPreview" src="#" alt="Pré-visualização da Imagem" style="display:none; margin-top:10px; max-width:200px;">
            </div>
        </fieldset>

        <fieldset class="border rounded p-4 mb-4">
            <legend class="w-auto px-2">Dados Bancários</legend>
            <div class="row">
                <div class="form-group col-md-4">
                    <label for="nomeBanco">Banco:</label>
                    <input type="text" class="form-control" name="nomeBanco">
                </div>
                <div class="form-group col-md-4">
                    <label for="agencia">Agência:</label>
                    <input type="text" class="form-control" name="agencia">
                </div>
                <div class="form-group col-md-4">
                    <label for="contaBanco">Conta:</label>
                    <input type="text" class="form-control" name="contaBanco">
                </div>
            </div>
        </fieldset>

        <fieldset class="border rounded p-4 mb-4">
            <legend class="w-auto px-2">Informações Profissionais</legend>
            <div class="row">
                <div class="form-group col-md-6">
                    <label for="matricula">Matrícula:</label>
                    <input type="number" class="form-control" name="matricula" required>
                </div>
                <div class="form-group col-md-6">
                    <label for="dataAdmissao">Data de Admissão:</label>
                    <input type="date" class="form-control" name="dataAdmissao" required>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-6">
                    <label for="cargo">Cargo:</label>
                    <select class="form-control" name="cargo" required>
                        <option value="" disabled selected>Selecione uma opção</option>                        <option value="Assistente social">Assistente social</option>
                        <option value="Administrador">Administrador</option>
                        <option value="Psicólogo">Psicólogo</option>
                        <option value="Psiquiatra">Psiquiatra</option>
                    </select>
                </div>
                <div class="form-group col-md-6">
                    <label for="vinculo">Vínculo:</label>
                    <select class="form-control" name="vinculo" required>
                        <option value="" disabled selected>Selecione uma opção</option>                        <option value="Servidor">Servidor</option>
                        <option value="Voluntario">Voluntário</option>
                    </select>
                </div>
            </div>
        </fieldset>

        <fieldset class="border rounded p-4 mb-4">
            <legend class="w-auto px-2">Endereço</legend>
            <div class="row">
                <div class="form-group col-md-4">
                    <label for="cep">CEP:</label>
                    <input type="text" class="form-control" name="cep" required pattern="\d{8}" title="Deve conter 8 dígitos" id="cep"  onblur="buscarEndereco()">
                </div>
                <div class="form-group col-md-8">
                    <label for="endereco">Endereço:</label>
                    <input type="text" class="form-control" name="endereco" required id="endereco">
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-4">
                    <label for="bairro">Bairro:</label>
                    <input type="text" class="form-control" name="bairro" required id="bairro">
                </div>
                <div class="form-group col-md-4">
                    <label for="cidade">Cidade:</label>
                    <input type="text" class="form-control" name="cidade" required id="cidade">
                </div>
                <div class="form-group col-md-4">
                    <label for="estado">Estado:</label>
                    <input type="text" class="form-control" name="estado" required id="estado" readonly>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-6">
                    <label for="numero">Número:</label>
                    <input type="text" class="form-control" name="numero" required>
                </div>
                <div class="form-group col-md-6">
                    <label for="complemento">Complemento:</label>
                    <input type="text" class="form-control" name="complemento">
                </div>
            </div>
        </fieldset>

        <fieldset class="border rounded p-4 mb-4">
            <legend class="w-auto px-2">Contato</legend>
            <div class="row">
                <div class="form-group col-md-6">
                    <label for="telefone">Telefone:</label>
                    <input type="text" class="form-control" name="telefone" pattern="\d{10,11}" title="Deve conter 10 ou 11 dígitos">
                </div>
                <div class="form-group col-md-6">
                    <label for="tipoTelefone">Tipo de Telefone:</label>
                    <select class="form-control" name="tipoTelefone">
                        <option value="Celular">Celular</option>
                        <option value="Residencial">Residencial</option>
                        <option value="Comercial">Comercial</option>
                    </select>
                </div>
            </div>
        </fieldset>

        <fieldset class="border rounded p-4 mb-4">
            <legend class="w-auto px-2">Contato de Emergência</legend>
            <div class="row">
                <div class="form-group col-md-6">
                    <label for="contatoEmergenciaNome">Nome:</label>
                    <input type="text" class="form-control" name="contatoEmergenciaNome">
                </div>
                <div class="form-group col-md-6">
                    <label for="telefoneContatoEmergencia">Telefone:</label>
                    <input type="text" class="form-control" name="telefoneContatoEmergencia" pattern="\d{10,11}" title="Deve conter 10 ou 11 dígitos">
                </div>
            </div>
        </fieldset>

        <div class="text-center">
            <button type="submit" class="btn btn-primary">Criar Profissional</button>
            <button type="reset" class="btn btn-secondary">Limpar Formulário</button>
        </div>
    </form>
</main>

<script>
    async function buscarEndereco() {
        const cep = document.getElementById('cep').value.replace('-', '');
        if (cep) {
            try {
                const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                const data = await response.json();

                if (!data.erro) {
                    document.getElementById('endereco').value = data.logradouro || '';
                    document.getElementById('bairro').value = data.bairro || '';
                    document.getElementById('cidade').value = data.localidade || '';
                    document.getElementById('estado').value = data.uf || '';
                } else {
                    alert('CEP não encontrado.');
                }
            } catch (error) {
                alert('Erro ao buscar o endereço.');
            }
        }
    }
</script>